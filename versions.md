# История версий WebToMarkdown

## Схема версионирования

Приложение использует **Semantic Versioning (SemVer)** в формате `MAJOR.MINOR.PATCH`:

- **MAJOR** - несовместимые изменения API, крупные архитектурные изменения
- **MINOR** - новая функциональность (обратная совместимость)
- **PATCH** - исправления багов, мелкие улучшения (обратная совместимость)

## Схема versionCode

Для Google Play Store используется `versionCode` - целое число, которое должно увеличиваться с каждым релизом:

```
versionCode = MAJOR * 10 + MINOR * 10 + PATCH
```

Примеры:
- 1.0.0 → versionCode = 10
- 1.1.0 → versionCode = 11
- 1.2.1 → versionCode = 13
- 2.0.0 → versionCode = 20

## История версий

### Версия 1.9.2 - 12.09.2025
- **versionCode**: 30
- **versionName**: "1.9.2"
- **Изменения**:
  - Исправлен баг с невидимостью кнопок "Обработать" и "Сохранить" на главном экране
  - Отключено "перекрашивание" нижней системной навигационной панели

### Версия 1.9.1 - 12.09.2025
- **versionCode**: 29
- **versionName**: "1.9.1"
- **Изменения**:
- Добавлена иконка приложения

### Версия 1.9.0 - 10.09.2025
- **versionCode**: 28
- **versionName**: "1.9.0"
- **Изменения**:
  - Добавлена поддержка светлой и тёмной тем с возможностью выбора "светлая/тёмная/как в системе"
  - Создана цветовая схема: основной цвет #0b2b6a (тёмно-синий) для светлой темы, #71c5e8 (светло-голубой) для тёмной темы
  - Реализована адаптивная подсветка системных баров (строка уведомлений и навигационная панель) с edge-to-edge отображением
  - Настроена совместимость с Material Design 3 и современными версиями Android

### Версия 1.8.6 - 09.09.2025
- **versionCode**: 27
- **versionName**: "1.8.6"
- **Изменения**:
 - Исправлен баг с сохранением изображений - теперь папки с изображениями создаются в выбранной пользователем директории, а не в кэше приложения
 - Исправлен баг с именем папки для изображений, которое не менялось при переименовании заметки перед сохранением
 - Исправлено обновление ссылок на изображения - ссылки в Markdown теперь корректно заменяются на актуальные пути при сохранении
 - Улучшена совместимость с Obsidian - изменен формат ссылок на изображения с ![alt](./path) на ![[image.png]] для корректного отображения в Obsidian
 - Рефакторинг архитектуры - вся логика сохранения перенесена из MainActivity в FileSaveHandler для лучшей модульности
 - Добавлено подробное логирование - улучшена отладка процесса сохранения и обработки изображений
 - Исправлена работа с Storage Access Framework (SAF)
 - Добавлена поддержка отложенного сохранения при выборе папки
 - Улучшена обработка временных папок с изображениями

### Версия 1.8.5 - 30.08.2025
- **versionCode**: 26
- **versionName**: "1.8.5"
- **Изменения**:
  - Добавлен пункт "О приложении" на экране настроек

### Версия 1.8.4 - 30.08.2025
- **versionCode**: 25
- **versionName**: "1.8.4"
- **Изменения**:
  - Исправлен баг с переименованием заметок: теперь папка с изображениями создается с пользовательским именем файла
  - Добавлен параметр `customFileName` в функцию `processPage()` для передачи пользовательского имени
  - Улучшена логика создания папок с изображениями - приоритет отдается пользовательскому имени

### Версия 1.8.3 - 30.08.2025
- **versionCode**: 24
- **versionName**: "1.8.3"
- **Изменения**:
  - Добавлено автоматическое распознавание языка программирования в блоках кода
  - Улучшена обработка тегов `<pre><code class="java">` - теперь язык добавляется после ` ``` ` в Markdown
  - Поддерживаются языки: Java, Kotlin, JavaScript, Python, C++, C#, PHP, Ruby, Go, Rust, Swift, TypeScript, HTML, CSS, XML, JSON, YAML, SQL, Bash
  - Добавлена функция `extractProgrammingLanguage()` для извлечения языка из HTML атрибутов

### Версия 1.8.2 - 30.08.2025
- **versionCode**: 23
- **versionName**: "1.8.2"
- **Изменения**:
  - Исправлены ссылки на изображения в заметках: теперь используются относительные пути в формате `./folder-name/image_***.***`
  - Добавлен паттерн для skillbox.ru
  - Скорректирован паттерн для ixbt.com 
  - Корректировка интерфейса главного меню

### Версия 1.8.1 - 27.08.2025
- **versionCode**: 22
- **versionName**: "1.8.1"
- **Изменения**:
  - Корректировка интерфейса главного меню

### Версия 1.8.0 - 27.08.2025
- **versionCode**: 21
- **versionName**: "1.8.0"
- **Изменения**:
  - Паттерны возвращают исходный HTML
  - Добавлен паттерн для `qna.habr.com`
  - Добавлена конвертация `<blockquote>` в `> [!NOTE]` базовым алгоритмом обработки
  - Добавлена поддержка inline-кода (`code`) и блоков кода (`pre` + `code`) с тройными обратными кавычками

### Версия 1.7.0 - 23.08.2025
- **versionCode**: 20
- **versionName**: "1.7.0"
- **Изменения**:
  - Интеграция паттернов (habr.com, pikabu.ru, ixbt.com) в обработку контента
  - Добавлен переключатель "Использовать паттерны обработки сайтов"
  - Переименован блок "Настройки изображений" в "Обработка контента"
  - Добавлена сворачиваемая строка со списком поддерживаемых доменов паттернов в настройках

### Версия 1.6.0 - 23.08.2025
- **versionCode**: 19
- **versionName**: "1.6.0"
- **Изменения**: Доработка и улучшение UI
  - Заменена иконка меню на более подходящую (Settings)
  - Добавлены иконки к кнопкам в нижней панели
  - Добавлены анимации переходов между экранами
  - Добавлены анимации появления/исчезновения элементов
  - Добавлена кнопка "Вставить из буфера обмена"
  - Добавлены анимации кнопок при нажатии
  - Добавлены Toast-сообщения о статусе операций
  - Добавлены уведомления о завершении обработки
  - Исправлена обработка кнопки "назад" в настройках

### Версия 1.5.2 - 23.08.2025
- **versionCode**: 18
- **versionName**: "1.5.2"
- **Изменения**: Исправлена ошибка сохранения настроек приложения между сессиями

### Версия 1.5.1 - 23.08.2025
- **versionCode**: 17
- **versionName**: "1.5.1"
- **Изменения**: Улучшение меню настроек

### Версия 1.5.0 - 23.08.2025
- **versionCode**: 16
- **versionName**: "1.5.0"
- **Изменения**: Добавлено скачивание и сохранение изображений вместе с заметкой

### Версия 1.4.0 - 21.08.2025
- **versionCode**: 15
- **versionName**: "1.4.0"
- **Изменения**: Добавлено получение и обработка ссылок из браузера через меню "Поделиться"

### Версия 1.3.0 - 21.08.2025
- **versionCode**: 14
- **versionName**: "1.3.0"
- **Изменения**: Доработка интерфейса

### Версия 1.2.1 - 21.08.2025
- **versionCode**: 13
- **versionName**: "1.2.1"
- **Изменения**: 
  - Обновление библиотек, Kotlin, JDK и инструментов сборки
  - Исправление ошибок в WebContentProcessor.kt
  - Upgrade AGP dependency from 8.12.0 to 8.12.1

### Версия 1.2.0 - 20-21.08.2025
- **versionCode**: 12
- **versionName**: "1.2.0"
- **Изменения**: Рефакторинг архитектуры
  - Логика обработки текстового содержимого вынесена в WebContentProcessor.kt
  - Логика сохранения файла вынесена в FileSaveHandler.kt
  - Логика скачивания веб-страницы вынесена в WebDownloader.kt
  - Оптимизировано взаимодействие между компонентами

### Версия 1.1.0 - 20.08.2025
- **versionCode**: 11
- **versionName**: "1.1.0"
- **Изменения**: Добавление базового функционала
  - Добавлен Splash Screen
  - Добавлены настройки сохранения (enum FileNameOption и SaveLocationOption)
  - Добавлена кнопка "Очистить" в главном меню

### Версия 1.0.0 - 18.08.2025
- **versionCode**: 10
- **versionName**: "1.0.0"
- **Изменения**: Первый релиз
  - Базовая функциональность приложения
  - Главное меню
  - Сохранение файлов
  - Комментарии

## Правила для будущих обновлений

### Когда увеличивать MAJOR версию (1.x.x → 2.0.0):
- Крупные изменения архитектуры
- Удаление важных функций
- Несовместимые изменения API
- Полная переработка интерфейса

### Когда увеличивать MINOR версию (1.1.x → 1.2.0):
- Добавление новых функций
- Улучшения интерфейса
- Новые возможности
- Рефакторинг кода

### Когда увеличивать PATCH версию (1.1.1 → 1.1.2):
- Исправления багов
- Мелкие улучшения
- Обновления зависимостей
- Исправления безопасности

## Как обновить версию

1. Откройте файл `app/build.gradle.kts`
2. Найдите блок `defaultConfig`
3. Обновите `versionCode` и `versionName`
4. Сделайте коммит с сообщением вида: "Версия 1.5.3 - [описание изменений]"

### Пример обновления:

```kotlin
defaultConfig {
    applicationId = "com.jack3995.webtomarkdown"
    minSdk = 26
    targetSdk = 36
    versionCode = 19  // Увеличиваем на 1
    versionName = "1.5.3"  // Новая версия
    
    testInstrumentationRunner = "androidx.test.runner.AndroidJUnitRunner"
}
```

## Полезные команды Git

```bash
# Посмотреть историю коммитов
git log --oneline

# Посмотреть коммиты с датами
git log --pretty=format:"%h - %an, %ar : %s"

# Создать тег для версии
git tag -a v1.5.2 -m "Версия 1.5.2"
git push origin v1.5.2
```
